{"ast":null,"code":"import axios from 'axios';\nimport { CART_ADD_ITEM, CART_REMOVE_ITEM, CART_SAVE_SHIPPING_ADDRESS, CART_SAVE_PAYMENT_METHOD, CART_ITEMS_MY_REQ, CART_ITEMS_REQ_FAIL, CART_ITEMS_REQ_SUCCESS, CART_ITEMS_RESET } from '../constants/cartConstants';\nimport { logout } from './userActions';\nexport const addToCart = (id, qty, purchase) => async (dispatch, getState) => {\n  const {\n    data\n  } = await axios.get(`/api/products/${id}`);\n  dispatch({\n    type: CART_ADD_ITEM,\n    payload: {\n      product: data._id,\n      original_title: data.original_title,\n      poster_path: data.poster_path,\n      price: purchase === \"Buy\" ? data.price : data.rent_price,\n      purchase: purchase,\n      expiry_date: purchase === \"Rent\" ? new Date(new Date().getTime() + 10 * 86400000).toLocaleString() : \"N/A\",\n      availableToRent: data.availableToRent,\n      qty\n    }\n  }); // const {\n  //   userLogin: { userInfo },\n  // } = getState()\n  //\n  //\n  // if(userInfo) {\n  //\n  //   const config = {\n  //     headers: {\n  //       Authorization: `Bearer ${userInfo.token}`,\n  //     },\n  //   }\n  //   const { data } = await axios.put(`/api/users/mycart/items`, getState().cart, config)\n  //   dispatch({type: CART_ITEMS_REQ_SUCCESS,\n  //     payload: data})\n  // }\n\n  localStorage.setItem('cartItems', JSON.stringify(getState().cart.cartItems));\n};\nexport const removeFromCart = id => (dispatch, getState) => {\n  dispatch({\n    type: CART_REMOVE_ITEM,\n    payload: id\n  });\n  localStorage.setItem('cartItems', JSON.stringify(getState().cart.cartItems));\n};\nexport const saveShippingAddress = data => dispatch => {\n  dispatch({\n    type: CART_SAVE_SHIPPING_ADDRESS,\n    payload: data\n  });\n  localStorage.setItem('shippingAddress', JSON.stringify(data));\n};\nexport const savePaymentMethod = data => dispatch => {\n  dispatch({\n    type: CART_SAVE_PAYMENT_METHOD,\n    payload: data\n  });\n  localStorage.setItem('paymentMethod', JSON.stringify(data));\n};\nexport const listMyCartItems = () => async (dispatch, getState) => {\n  try {\n    dispatch({\n      type: CART_ITEMS_MY_REQ\n    });\n    const {\n      userLogin: {\n        userInfo\n      }\n    } = getState();\n    const config = {\n      headers: {\n        Authorization: `Bearer ${userInfo.token}`\n      }\n    };\n    const {\n      data\n    } = await axios.get(`/api/users/mycart/items`, config);\n    console.log(data);\n    dispatch({\n      type: CART_ITEMS_REQ_SUCCESS,\n      payload: data\n    });\n  } catch (error) {\n    const message = error.response && error.response.data.message ? error.response.data.message : error.message;\n\n    if (message === 'Not authorized, token failed') {\n      dispatch(logout());\n    }\n\n    dispatch({\n      type: CART_ITEMS_REQ_FAIL,\n      payload: message\n    });\n  }\n};","map":{"version":3,"names":["axios","CART_ADD_ITEM","CART_REMOVE_ITEM","CART_SAVE_SHIPPING_ADDRESS","CART_SAVE_PAYMENT_METHOD","CART_ITEMS_MY_REQ","CART_ITEMS_REQ_FAIL","CART_ITEMS_REQ_SUCCESS","CART_ITEMS_RESET","logout","addToCart","id","qty","purchase","dispatch","getState","data","get","type","payload","product","_id","original_title","poster_path","price","rent_price","expiry_date","Date","getTime","toLocaleString","availableToRent","localStorage","setItem","JSON","stringify","cart","cartItems","removeFromCart","saveShippingAddress","savePaymentMethod","listMyCartItems","userLogin","userInfo","config","headers","Authorization","token","console","log","error","message","response"],"sources":["/Users/vk/Downloads/INFO6150_Final_Project-main/StreamingDome/frontend/src/actions/cartActions.js"],"sourcesContent":["import axios from 'axios'\nimport {\n  CART_ADD_ITEM,\n  CART_REMOVE_ITEM,\n  CART_SAVE_SHIPPING_ADDRESS,\n  CART_SAVE_PAYMENT_METHOD,\n  CART_ITEMS_MY_REQ,\n  CART_ITEMS_REQ_FAIL,\n  CART_ITEMS_REQ_SUCCESS,\n  CART_ITEMS_RESET\n} from '../constants/cartConstants'\n\nimport { logout } from './userActions'\n\n\nexport const addToCart = (id, qty, purchase) => async (dispatch, getState) => {\n  const { data } = await axios.get(`/api/products/${id}`)\n\n  dispatch({\n    type: CART_ADD_ITEM,\n    payload: {\n      product: data._id,\n      original_title: data.original_title,\n      poster_path: data.poster_path,\n      price: purchase === \"Buy\" ? data.price : data.rent_price,\n      purchase: purchase,\n      expiry_date: purchase === \"Rent\" ? new Date((new Date()).getTime() + (10 * 86400000)).toLocaleString() : \"N/A\",\n      availableToRent: data.availableToRent,\n      qty,\n    },\n  })\n\n  // const {\n  //   userLogin: { userInfo },\n  // } = getState()\n  //\n  //\n  // if(userInfo) {\n  //\n  //   const config = {\n  //     headers: {\n  //       Authorization: `Bearer ${userInfo.token}`,\n  //     },\n  //   }\n  //   const { data } = await axios.put(`/api/users/mycart/items`, getState().cart, config)\n  //   dispatch({type: CART_ITEMS_REQ_SUCCESS,\n  //     payload: data})\n  // }\n  localStorage.setItem('cartItems', JSON.stringify(getState().cart.cartItems))\n}\n\nexport const removeFromCart = (id) => (dispatch, getState) => {\n  dispatch({\n    type: CART_REMOVE_ITEM,\n    payload: id,\n  })\n\n  localStorage.setItem('cartItems', JSON.stringify(getState().cart.cartItems))\n}\n\nexport const saveShippingAddress = (data) => (dispatch) => {\n  dispatch({\n    type: CART_SAVE_SHIPPING_ADDRESS,\n    payload: data,\n  })\n\n  localStorage.setItem('shippingAddress', JSON.stringify(data))\n}\n\nexport const savePaymentMethod = (data) => (dispatch) => {\n  dispatch({\n    type: CART_SAVE_PAYMENT_METHOD,\n    payload: data,\n  })\n\n  localStorage.setItem('paymentMethod', JSON.stringify(data))\n}\n\nexport const listMyCartItems = () => async (dispatch, getState) => {\n  try {\n    dispatch({\n      type: CART_ITEMS_MY_REQ,\n    })\n\n    const {\n      userLogin: { userInfo },\n    } = getState()\n\n    const config = {\n      headers: {\n        Authorization: `Bearer ${userInfo.token}`,\n      },\n    }\n\n    const { data } = await axios.get(`/api/users/mycart/items`, config)\n    console.log(data)\n\n    dispatch({\n      type: CART_ITEMS_REQ_SUCCESS,\n      payload: data,\n    })\n  } catch (error) {\n    const message =\n        error.response && error.response.data.message\n            ? error.response.data.message\n            : error.message\n    if (message === 'Not authorized, token failed') {\n      dispatch(logout())\n    }\n    dispatch({\n      type: CART_ITEMS_REQ_FAIL,\n      payload: message,\n    })\n  }\n}\n"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SACEC,aADF,EAEEC,gBAFF,EAGEC,0BAHF,EAIEC,wBAJF,EAKEC,iBALF,EAMEC,mBANF,EAOEC,sBAPF,EAQEC,gBARF,QASO,4BATP;AAWA,SAASC,MAAT,QAAuB,eAAvB;AAGA,OAAO,MAAMC,SAAS,GAAG,CAACC,EAAD,EAAKC,GAAL,EAAUC,QAAV,KAAuB,OAAOC,QAAP,EAAiBC,QAAjB,KAA8B;EAC5E,MAAM;IAAEC;EAAF,IAAW,MAAMhB,KAAK,CAACiB,GAAN,CAAW,iBAAgBN,EAAG,EAA9B,CAAvB;EAEAG,QAAQ,CAAC;IACPI,IAAI,EAAEjB,aADC;IAEPkB,OAAO,EAAE;MACPC,OAAO,EAAEJ,IAAI,CAACK,GADP;MAEPC,cAAc,EAAEN,IAAI,CAACM,cAFd;MAGPC,WAAW,EAAEP,IAAI,CAACO,WAHX;MAIPC,KAAK,EAAEX,QAAQ,KAAK,KAAb,GAAqBG,IAAI,CAACQ,KAA1B,GAAkCR,IAAI,CAACS,UAJvC;MAKPZ,QAAQ,EAAEA,QALH;MAMPa,WAAW,EAAEb,QAAQ,KAAK,MAAb,GAAsB,IAAIc,IAAJ,CAAU,IAAIA,IAAJ,EAAD,CAAaC,OAAb,KAA0B,KAAK,QAAxC,EAAmDC,cAAnD,EAAtB,GAA4F,KANlG;MAOPC,eAAe,EAAEd,IAAI,CAACc,eAPf;MAQPlB;IARO;EAFF,CAAD,CAAR,CAH4E,CAiB5E;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EACAmB,YAAY,CAACC,OAAb,CAAqB,WAArB,EAAkCC,IAAI,CAACC,SAAL,CAAenB,QAAQ,GAAGoB,IAAX,CAAgBC,SAA/B,CAAlC;AACD,CAlCM;AAoCP,OAAO,MAAMC,cAAc,GAAI1B,EAAD,IAAQ,CAACG,QAAD,EAAWC,QAAX,KAAwB;EAC5DD,QAAQ,CAAC;IACPI,IAAI,EAAEhB,gBADC;IAEPiB,OAAO,EAAER;EAFF,CAAD,CAAR;EAKAoB,YAAY,CAACC,OAAb,CAAqB,WAArB,EAAkCC,IAAI,CAACC,SAAL,CAAenB,QAAQ,GAAGoB,IAAX,CAAgBC,SAA/B,CAAlC;AACD,CAPM;AASP,OAAO,MAAME,mBAAmB,GAAItB,IAAD,IAAWF,QAAD,IAAc;EACzDA,QAAQ,CAAC;IACPI,IAAI,EAAEf,0BADC;IAEPgB,OAAO,EAAEH;EAFF,CAAD,CAAR;EAKAe,YAAY,CAACC,OAAb,CAAqB,iBAArB,EAAwCC,IAAI,CAACC,SAAL,CAAelB,IAAf,CAAxC;AACD,CAPM;AASP,OAAO,MAAMuB,iBAAiB,GAAIvB,IAAD,IAAWF,QAAD,IAAc;EACvDA,QAAQ,CAAC;IACPI,IAAI,EAAEd,wBADC;IAEPe,OAAO,EAAEH;EAFF,CAAD,CAAR;EAKAe,YAAY,CAACC,OAAb,CAAqB,eAArB,EAAsCC,IAAI,CAACC,SAAL,CAAelB,IAAf,CAAtC;AACD,CAPM;AASP,OAAO,MAAMwB,eAAe,GAAG,MAAM,OAAO1B,QAAP,EAAiBC,QAAjB,KAA8B;EACjE,IAAI;IACFD,QAAQ,CAAC;MACPI,IAAI,EAAEb;IADC,CAAD,CAAR;IAIA,MAAM;MACJoC,SAAS,EAAE;QAAEC;MAAF;IADP,IAEF3B,QAAQ,EAFZ;IAIA,MAAM4B,MAAM,GAAG;MACbC,OAAO,EAAE;QACPC,aAAa,EAAG,UAASH,QAAQ,CAACI,KAAM;MADjC;IADI,CAAf;IAMA,MAAM;MAAE9B;IAAF,IAAW,MAAMhB,KAAK,CAACiB,GAAN,CAAW,yBAAX,EAAqC0B,MAArC,CAAvB;IACAI,OAAO,CAACC,GAAR,CAAYhC,IAAZ;IAEAF,QAAQ,CAAC;MACPI,IAAI,EAAEX,sBADC;MAEPY,OAAO,EAAEH;IAFF,CAAD,CAAR;EAID,CAtBD,CAsBE,OAAOiC,KAAP,EAAc;IACd,MAAMC,OAAO,GACTD,KAAK,CAACE,QAAN,IAAkBF,KAAK,CAACE,QAAN,CAAenC,IAAf,CAAoBkC,OAAtC,GACMD,KAAK,CAACE,QAAN,CAAenC,IAAf,CAAoBkC,OAD1B,GAEMD,KAAK,CAACC,OAHhB;;IAIA,IAAIA,OAAO,KAAK,8BAAhB,EAAgD;MAC9CpC,QAAQ,CAACL,MAAM,EAAP,CAAR;IACD;;IACDK,QAAQ,CAAC;MACPI,IAAI,EAAEZ,mBADC;MAEPa,OAAO,EAAE+B;IAFF,CAAD,CAAR;EAID;AACF,CApCM"},"metadata":{},"sourceType":"module"}